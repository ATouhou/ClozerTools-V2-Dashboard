(function(a){a.bookshelfSlider=function(b,c){function x(){var c=a(b+" #products_box_"+r+" .product:last-child");var d=c.height()+c.offset().top;var f=e.height()+e.offset().top;if(d-143<f){v.css("opacity",.3)}if(d>f){return true}else{return false}}function y(){var c=a(b+" #products_box_"+r+" .product:first-child");var d=c.offset().top;var f=e.offset().top;if(d+143>f){w.css("opacity",.3)}if(d<f){return true}else{return false}}function z(){if(new Date-A<C){setTimeout(z,C)}else{B=false;r=0;t[0]=undefined;a(b+" .slide_animate").css("top",0);a(b+" #btn1").trigger("click")}}if(c){a.extend(a.bookshelfSlider.config,c)}var d=a.bookshelfSlider.config;var e=a(b+" .panel_slider");var f=a(b+" #arrow_menu");var g=a(b+" .slide_animate");var h=a(b+" .button_bar");var i=a(b+" .buttons_container");if(a.browser.msie&&parseInt(a.browser.version)==7){var j=true}if(a.browser.msie&&parseInt(a.browser.version)==8){var k=true}e.width(d.item_width);e.height(d.item_height);g.width(e.width());g.height(d.item_height+5e3);h.css("margin-left",d.buttons_margin);if(!j){switch(d.buttons_align){case"left":i.css("float","left");break;case"center":var l=0;a(b+" .button_bar").each(function(){l+=a(this).width()+d.buttons_margin});l+=20;var m=parseInt(l/e.width()*100);i.css("width",m+"%");break;case"right":i.css("float","right");i.css("margin-right",d.buttons_margin);break}}a(b+" .panel_bar").width(d.item_width);a(b+" .panel_title").width(d.item_width);a(b+" .product").css("margin-right",d.product_margin);var n=parseInt(h.css("margin-left"));var o=a(b+" #btn1").position().left+n+a(b+" #btn1").width()/2-10;f.css("left",o);f.show();a(b+" .panel_items").css("width","99999");if(d.show_selected_title){a(b+" .selected_title_box").show();a(b+" .selected_title").text(a("#btn1").text())}a(b+" .products_box").css("margin-left",d.products_box_margin_left);a(b+" .product").each(function(c){var e=a(this);if(e.attr("title")!=""&&e.attr("title")!="undefined"){var f=true}else{var f=false}var g=e.children("img");c++;if(f&&d.product_show_title){e.append("<div class='product_title' id='title_"+c+"'><p>"+e.attr("title")+"</p></div>");var h=a(b+" #title_"+c);var i=g.height()-a(h).height()/2;h.css({left:(e.width()-h.width()-6)/2,top:i});h.css({color:d.product_title_textcolor,background:d.product_title_bgcolor+" url(assets/title_product_bg.png) repeat"})}e.mouseenter(function(){a(h).css({overflow:"visible","max-height":80});a(b+" #i_zoom_"+c).css({"background-position":"-24px 0"});a(b+" #i_play_"+c).css({"background-position":"-72px 0"});a(b+" #i_link_"+c).css({"background-position":"-120px 0"});a(b+" #i_iframe_"+c).css({"background-position":"-168px 0"})}).mouseleave(function(){a(h).css({overflow:"hidden","max-height":11});a(b+" #i_zoom_"+c).css({"background-position":"0 0"});a(b+" #i_play_"+c).css({"background-position":"-48px 0"});a(b+" #i_link_"+c).css({"background-position":"-96px 0"});a(b+" #i_iframe_"+c).css({"background-position":"-144px 0"})});e.children("img").addClass("img_thumb");var k=e.attr("data-type");if(k=="book"){e.append("<img class='fx_book' id='b_"+c+"' + src='assets/book_fx.png' />");if(j){a(b+" #b_"+c).css({height:g.height()+4,top:e.height()-g.height()-4})}else{a(b+" #b_"+c).css({height:g.height(),top:e.height()-g.height()})}}else if(k=="magazine"){e.append("<img class='fx_magazine' id='m_"+c+"' + src='assets/magazine_fx.png' />");if(j){a(b+" #m_"+c).css({height:g.height()+4,top:e.height()-g.height()-4})}else{a(b+" #m_"+c).css({height:g.height(),top:e.height()-g.height()})}}else if(k=="cd"){e.append("<img class='fx_cd' id='cd_"+c+"' + src='assets/cd_fx.png' />");if(j){a(b+" #cd_"+c).css({height:g.height()+4,top:e.height()-g.height()-4})}else{a(b+" #cd_"+c).css({height:g.height(),top:e.height()-g.height()})}}else if(k=="dvd"){e.append("<img class='fx_cd' id='dvd_"+c+"' + src='assets/dvd_fx.png' />");if(j){a(b+" #dvd_"+c).css({height:g.height()+4,top:e.height()-g.height()-4})}else{a(b+" #dvd_"+c).css({height:g.height(),top:e.height()-g.height()})}}e.append("<img class='fx_shadow' id='shd_"+c+"' + src='assets/shadow_fx.png' />");if(d.show_icons){var l=e.attr("data-url");var m=e.attr("data-popup");if(l!=undefined){var n=j?2:0;if(m=="true"&&(l.indexOf(".jpg")!=-1||l.indexOf(".gif")!=-1||l.indexOf(".png")!=-1)){e.append("<div class='icons_sprite' id='i_zoom_"+c+"'></div>");var o=a(b+" #i_zoom_"+c);o.css({"background-position":"0 0",left:(g.width()-o.width())/2+n,top:e.height()-g.height()/2-o.height()/2-n,opacity:1})}else if(m=="true"&&(l.indexOf("youtube.com")!=-1||l.indexOf("vimeo.com")!=-1)){e.append("<div class='icons_sprite' id='i_play_"+c+"'></div>");var p=a(b+" #i_play_"+c);p.css({"background-position":"-48px 0",left:(g.width()-p.width())/2+n,top:e.height()-g.height()/2-p.height()/2-n,opacity:1})}else if(m=="true"&&l!=""&&l!=undefined){e.append("<div class='icons_sprite' id='i_iframe_"+c+"'></div>");var q=a(b+" #i_iframe_"+c);q.css({"background-position":"-144px 0",left:(g.width()-q.width())/2+n,top:e.height()-g.height()/2-q.height()/2-n,opacity:1})}else if(l!=""&&l!=undefined){e.append("<div class='icons_sprite' id='i_link_"+c+"'></div>");var r=a(b+" #i_link_"+c);r.css({"background-position":"-96px 0",left:(g.width()-r.width())/2+n,top:e.height()-g.height()/2-r.height()/2-n,opacity:1})}}}if(e.height()!=g.height()){var s=e.height()-g.height();if(j){g.css("top",s-4);a(b+" #shd_"+c).css({height:g.height()+4,left:g.width()+4,top:s-4})}else{g.css("top",s);a(b+" #shd_"+c).css({height:g.height(),left:g.width(),top:s})}if(f&&d.product_show_title){a(h).css("top",e.height()-a(h).height()/2)}}});var p=0;var q=0;h.click(function(c){c.preventDefault();var e=a(this);if(r-1==e.index())return false;if(parseInt(g.css("top"))!=0){g.animate({top:0,opacity:1},{duration:300})}var h=e.attr("id");var i=a(b+" #"+h);var j=i.position();var k=i.width();var l=j.left+n+k/2-10;f.animate({left:l},{duration:d.arrow_duration,easing:d.arrow_easing,complete:function(){if(d.show_selected_title)a(b+" .selected_title").text(i.text())}});q=parseInt(a(b+" .panel_slider").css("width"))*e.index();p=-q;g.animate({left:p,top:0},{duration:d.slide_duration,easing:d.slide_easing,complete:function(){}});s=0;v.css("opacity",.3);w.css("opacity",.3);r=e.index()+1;if(t[0]==undefined){a(g).each(function(a){t[a]=x();r++});r=e.index()+1}if(t[e.index()]){v.css("opacity",1);u.show();u.fadeTo("normal",1);a(b+" .panel_slider").mouseenter(function(){u.show();u.fadeTo("normal",1)}).mouseleave(function(){u.hide()})}else{u.hide()}});var r=0;var s=0;var t=[];a(b+" .panel_slider").append("<div id='more_minus_box'><input type='button' id='icon_minus' /><input type='button' id='icon_more' /></div>");var u=a(b+" #more_minus_box");var v=a(b+" #icon_more");var w=a(b+" #icon_minus");w.click(function(b){if(w.css("opacity")!=1)return;a(this).attr("disabled","disabled");var c=y();if(!c){return}s-=143;v.css("opacity",1);g.animate({left:p,top:-s},{duration:d.slide_duration/2,easing:d.slide_easing,complete:function(){w.removeAttr("disabled")}})});v.click(function(b){if(v.css("opacity")!=1)return;a(this).attr("disabled","disabled");var c=x();if(!c){return}s+=143;w.css("opacity",1);g.animate({left:p,top:-s},{duration:d.slide_duration/2,easing:d.slide_easing,complete:function(){v.removeAttr("disabled")}})});a(b+" .show_hide_titles").click(function(c){c.preventDefault();if(a(b+" .product_title").css("opacity")==1){a(b+" .product_title").stop().animate({opacity:0},400);a(this).css({opacity:.5})}else{a(b+" .product_title").stop().animate({opacity:1},500);a(this).css({opacity:1})}});a(b+" .show_hide_icons").click(function(c){c.preventDefault();if(a(b+" .icons_sprite").css("opacity")==1){a(b+" .icons_sprite").stop().animate({opacity:0},400);a(this).css({opacity:.5})}else{a(b+" .icons_sprite").stop().animate({opacity:1},400);a(this).css({opacity:1})}});a(b+" .product").click(function(b){function A(b,c,e,f){var g=a("#popup_info");g.delay(100).animate({top:l/2-g.height()/2,left:i/2-g.width()/2},400,function(){a("#preload_icon").remove()});var h=i/2-b/2;var j=l/2-c/2;g.delay(100).animate({height:c,width:b,top:j,left:h},400,function(){g.append(e);a(e).fadeIn(600);if(a(f).attr("title")!=""&&a(f).attr("title")!="undefined"&&d.show_title_in_popup){var c=a(f).attr("title");g.append("<div id='popup_title'><div id='bs_close_button'></div>"+c+"</div>");var h=parseInt(g.css("padding-left"));a("#popup_title").css({width:b+h,top:-(h*2),left:0});a("#popup_title").fadeIn(400);a("#popup_title").fadeTo("normal",1);a("#bs_close_button").click(function(){a("#mask_popup").hide();a("#mask_popup").remove();a("#popup_info").remove()})}})}b.preventDefault();var c=a(this);var e=c.attr("data-url");var f=c.attr("data-popup");if(f!="true"){if(e==undefined||e==""){return}else{window.open(e,"_blank");return}}if(f=="true"&&(e==undefined||e==""))return;a("body").append('<div id="mask_popup"></div>');a("body").append('<div id="popup_info"></div>');a("#popup_info").append("<img id='preload_icon' src='assets/preload.gif' />");var g=a("#mask_popup");var h=a("#popup_info");var i=a(window).width();var l=a(window).height();var m=a(document).height();g.css({width:i,height:m});g.fadeIn(400);g.fadeTo("normal",.7);h.css({top:l/2-h.height()/2,left:i/2-h.width()/2});var n=e.indexOf(".jpg")!=-1||e.indexOf(".gif")!=-1||e.indexOf(".png")!=-1?true:false;var o=e.indexOf("youtube.com")!=-1?true:false;var p=e.indexOf("vimeo.com")!=-1?true:false;var q=e.indexOf(".jpg")==-1&&e.indexOf(".gif")==-1&&e.indexOf(".png")==-1&&!p&&!o?true:false;if(n){var r=c;if(j||k){var s=a("<img />").attr("src",e+"?"+(new Date).getTime())}else{var s=a("<img />").attr("src",e)}s.load(function(){A(this.width,this.height,s,r);a(s).hide()})}else if(o){var t=e.split("?v=");var u="?autohide=2&autoplay=1&controls=1&disablekb=0&fs=1&hd=0&loop=0&rel=1&showinfo=0&showsearch=1&wmode=transparent&enablejsapi=1";var v='<iframe class="video_player" width="'+d.video_width_height[0]+'" height="'+d.video_width_height[1]+'" frameborder="0" src="http://www.youtube.com/embed/'+t[1]+u+'"></iframe>';A(d.video_width_height[0],d.video_width_height[1],v,c)}else if(p){var t=e.split("/").pop();var v='<iframe class="video_player" src="http://player.vimeo.com/video/'+t+'?title=0&byline=0&portrait=0&autoplay=1" width="'+d.video_width_height[0]+'" height="'+d.video_width_height[1]+'" frameborder="0"></iframe>';A(d.video_width_height[0],d.video_width_height[1],v,c)}else if(q){if(e.indexOf("?")!=-1){var w=e.split("?size=").pop().split("&");var x=w[0].split("x");var y=parseInt(x[0]),z=parseInt(x[1])}else{var y=d.iframe_width_height[0],z=d.iframe_width_height[1]}var v='<iframe id="iframe_content" src="'+e+'" width="'+y+'" height="'+z+'" frameborder="0"></iframe>';A(y,z,v,c)}a("#mask_popup").click(function(){a("#mask_popup").hide();a("#mask_popup").remove();a("#popup_info").remove()})});a(b+" #btn1").trigger("click");var A=new Date(1,1,2e3,12,0,0);var B=false;var C=200;a(window).resize(function(){A=new Date;if(B===false){B=true;setTimeout(z,C)}if(a(b).width()>a(window).width()){a(b).width(a(window).width());a(b+" .slide_animate").width(a(b+" .panel_slider").width());var c=a(b+" .panel_slider").width()*(r-1);a(b+" .slide_animate").css("left",-c)}if(a(b).width()<a(window).width()){a(b).width("100%");a(b+" .slide_animate").width(a(b+" .panel_slider").width());var c=a(b+" .panel_slider").width()*(r-1);a(b+" .slide_animate").css("left",-c)}if(a(b).width()>a("#popup_info").width()){var d=a("#popup_info");var e=a(window).width();var f=a(window).height();var g=a(document).height();d.css({top:f/2-d.height()/2,left:e/2-d.width()/2});var h=a("#mask_popup");h.css({width:e,height:f})}});return this};a.bookshelfSlider.config={item_width:355,item_height:320,products_box_margin_left:20,product_title_textcolor:"#ffffff",product_title_bgcolor:"#c33b4e",product_margin:30,product_show_title:true,show_title_in_popup:true,show_selected_title:true,show_icons:true,buttons_margin:10,buttons_align:"center",slide_duration:1e3,slide_easing:"easeInOutExpo",arrow_duration:800,arrow_easing:"easeInOutExpo",video_width_height:[500,290],iframe_width_height:[400,300]}})(jQuery)